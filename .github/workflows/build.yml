name: Build macOS App

on:
  push:
    branches: [ "main" ] # 본인의 메인 브랜치 이름으로 수정 (예: master)
  workflow_dispatch:     # 수동 실행 버튼 활성화

jobs:
  build:
    runs-on: macos-latest

    steps:
    - name: 코드를 체크아웃합니다
      uses: actions/checkout@v4

    - name: 파이썬 환경을 설정합니다
      uses: actions/setup-python@v5
      with:
        python-version: '3.10' # 사용하는 파이썬 버전으로 수정

    - name: 필요한 라이브러리를 설치합니다
      run: |
        python -m pip install --upgrade pip
        pip install pyinstaller
        # 만약 별도의 라이브러리가 필요하다면 아래 주석을 해제하고 추가하세요
        # pip install -r requirements.txt

    - name: PyInstaller로 범용(Universal2) 앱을 빌드합니다
      run: |
        # --target-arch universal2 옵션을 추가하여 Intel/M1 모두 지원
        pyinstaller --onefile --windowed --name "ImageEditor" --target-arch universal2 ./app/image_edit.py
        

    - name: 빌드된 파일을 업로드합니다
      uses: actions/upload-artifact@v4
      with:
        name: ImageEditor-macOS
        path: dist/ImageEditor.app # 또는 단일 실행 파일일 경우 dist/ImageEditor
